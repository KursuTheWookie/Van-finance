<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Savings</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --vanW:560; --vanH:260; --bodyX:60; --bodyY:86; --bodyW:460; --bodyH:118;

    /* Light default */
    --bg: transparent;         /* << transparent! */
    --text: #111;
    --muted: #555;
    --line: #222;
    --panel: #dadfe3;
  }
  @media (prefers-color-scheme: dark){
    :root{
      --bg: transparent;       /* weiterhin transparent */
      --text: #f2f2f2;
      --muted: #c8c8c8;
      --line: #e6e6e6;
      --panel: #9aa6ad;
    }
  }
  /* Reset / responsive */
  html,body{height:100%}
  body{
    margin:0; padding:0; background:var(--bg);
    font-family:Inter,Arial,sans-serif; text-align:center;
  }
  h2{margin:0 0 10px 0; font-weight:600; color:var(--text)}
  .wrap{position:relative; width:min(var(--vanW)*1px, 100%); margin:0 auto}
  svg{display:block; margin:0 auto; width:100%; height:auto}
  .fill{
    position:absolute; top:var(--bodyY)px; left:calc(var(--bodyX) * 1px);
    height:var(--bodyH)px; background:#2ecc71; z-index:-1; border-radius:16px;
    transform-origin:left center;
  }
  .row{margin-top:8px}
  input{
    padding:.5rem .7rem; font-size:1rem; width:200px; text-align:right;
    background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.2);
    color:var(--text); border-radius:6px; outline:none;
  }
  .info{margin-top:.35rem; color:var(--muted)}
</style>
</head>
<body>
<h2>Savings</h2>

<div class="wrap">
  <div id="fill" class="fill" style="width:0"></div>

  <!-- Crafter-like van, facing LEFT -->
  <svg viewBox="0 0 560 260" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <clipPath id="vanClip">
        <rect x="60" y="86" width="460" height="118" rx="16" ry="16"/>
        <path d="M520,86 L458,86 L435,118 L520,118 Z"/>
      </clipPath>
    </defs>

    <!-- Outline (no white fills, so dark backgrounds shine through) -->
    <rect x="60" y="86" width="460" height="118" rx="16" ry="16" fill="none" stroke="var(--line)" stroke-width="3"/>
    <path d="M60,86 h330 l15,-10 h70" fill="none" stroke="var(--line)" stroke-width="3"/>
    <path d="M520,86 L458,86 L435,118 L520,118 Z" fill="none" stroke="var(--line)" stroke-width="3"/>
    <path d="M502,90 L465,90 L447,114 L516,114" fill="var(--panel)" stroke="var(--line)" stroke-width="2"/>

    <path d="M520,118 L516,130 L520,148" fill="none" stroke="var(--line)" stroke-width="3"/>
    <line x1="95" y1="138" x2="380" y2="138" stroke="var(--muted)" stroke-width="1" opacity="0.45"/>
    <line x1="100" y1="162" x2="360" y2="162" stroke="var(--muted)" stroke-width="1" opacity="0.35"/>
    <line x1="100" y1="100" x2="100" y2="190" stroke="var(--muted)" stroke-width="1" opacity="0.45"/>

    <g>
      <circle cx="180" cy="204" r="24" fill="var(--line)"/>
      <circle cx="180" cy="204" r="10" fill="#888"/>
      <circle cx="420" cy="204" r="24" fill="var(--line)"/>
      <circle cx="420" cy="204" r="10" fill="#888"/>
    </g>

    <line id="paidTick" x1="0" y1="80" x2="0" y2="206" stroke="var(--muted)" stroke-dasharray="4 4" stroke-width="2"/>
    <text id="paidLabel" x="0" y="76" text-anchor="middle" font-size="12" fill="var(--muted)">van paid</text>
  </svg>
</div>

<div class="row">
  <input type="number" id="savings" placeholder="Savings (€)" />
  <div class="info" id="info">0% — 0€ of 60,000€</div>
</div>

<script>
  const goal = 60000, paidAt = 50000;
  const bodyX=60, bodyY=86, bodyW=460, bodyH=118;

  // theme override via URL ?theme=dark|light
  (function(){
    const q=new URLSearchParams(location.search);
    const t=q.get('theme');
    if(t==='dark'){
      document.documentElement.style.setProperty('--text','#f2f2f2');
      document.documentElement.style.setProperty('--muted','#c8c8c8');
      document.documentElement.style.setProperty('--line','#e6e6e6');
      document.documentElement.style.setProperty('--panel','#9aa6ad');
    } else if(t==='light'){
      document.documentElement.style.setProperty('--text','#111');
      document.documentElement.style.setProperty('--muted','#555');
      document.documentElement.style.setProperty('--line','#222');
      document.documentElement.style.setProperty('--panel','#dadfe3');
    }
  })();

  const fill   = document.getElementById('fill');
  const info   = document.getElementById('info');
  const input  = document.getElementById('savings');
  const paidTk = document.getElementById('paidTick');
  const paidLb = document.getElementById('paidLabel');

  function positionPaidMarker(){
    const px = bodyX + bodyW * (paidAt / goal);
    paidTk.setAttribute('x1', px); paidTk.setAttribute('x2', px);
    paidLb.setAttribute('x', px);
  }
  positionPaidMarker();

  function colorFor(p){
    if (p < 0.25) return '#e74c3c';   // red
    if (p < 0.75) return '#f1c40f';   // yellow
    return '#2ecc71';                 // green
  }

  function update(amount){
    const p = Math.max(0, Math.min(1, amount / goal));
    fill.style.width = (bodyW * p) + 'px';
    fill.style.background = colorFor(p);
    fill.style.clipPath = `path('M ${bodyX} ${bodyY} h ${bodyW} v ${bodyH} h -${bodyW} Z')`;
    info.textContent = `${(p*100).toFixed(1)}% — ${amount.toLocaleString()}€ of ${goal.toLocaleString()}€`;
    localStorage.setItem('van_savings', amount);
  }

  input.addEventListener('input', e => update(Number(e.target.value || 0)));

  const saved = Number(localStorage.getItem('van_savings') || 0);
  input.value = saved || '';
  update(saved);
</script>
</body>
</html>
