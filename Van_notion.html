<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Van Savings</title>
<style>
  :root{
    --bg: transparent;
    --text: #eaecef;
    --muted: #aeb6bc;
    --green: #7aa35f; /* Sage-Grün */
  }
  html,body{margin:0;background:var(--bg);color:var(--text);font:15px/1.4 system-ui}
  .wrap{max-width:900px;margin:0 auto;padding:10px}
  .stage{position:relative;width:100%;aspect-ratio:16/6}

  /* Basisbild: normaler (nicht-grüner) Van */
  .van-base{
    position:absolute; inset:0;
    background:url("https://kursuthewookie.github.io/Van-finance/img/crafter-side.png") center/contain no-repeat;
    pointer-events:none;
  }

  /* Overlay, das NUR in der Van-Silhouette sichtbar ist und links->rechts wächst */
  .van-fill{
    position:absolute; inset:0; width:0%;
    background:var(--green);
    /* Silhouetten-Maske (zeigt nur Van-Pixel) */
    -webkit-mask-image: url("https://kursuthewookie.github.io/Van-finance/img/crafter-side.png");
            mask-image: url("https://kursuthewookie.github.io/Van-finance/img/crafter-side.png");
    -webkit-mask-repeat: no-repeat;       mask-repeat: no-repeat;
    -webkit-mask-position: center;        mask-position: center;
    -webkit-mask-size: contain;           mask-size: contain;
    transition: width .25s ease;
    pointer-events:none;
  }

  .meta{display:flex;gap:12px;justify-content:center;align-items:center;margin:8px 0 6px;color:var(--muted)}
  .row{display:flex;gap:10px;justify-content:center;align-items:center;margin:.3rem 0 .6rem}
  input[type=number]{width:180px;padding:.5rem .6rem;border-radius:8px;
    border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.06);
    color:var(--text);text-align:right}
  label{opacity:.9}
</style>

<div class="wrap">
  <div class="stage">
    <div class="van-base"></div>
    <div class="van-fill" id="fill"></div>
  </div>

  <div class="meta">
    <span id="pct">0%</span>
    <span id="amt">0€ von 50 000€</span>
  </div>

  <div class="row">
    <label for="num">Ersparnis (€):</label>
    <input type="number" id="num" step="100" min="0" value="0" inputmode="numeric">
  </div>
</div>

<script>
(function(){
  const GOAL = 50000; // fixes Sparziel
  const num  = document.getElementById('num');
  const fill = document.getElementById('fill');
  const pct  = document.getElementById('pct');
  const amt  = document.getElementById('amt');

  const fmt = n => n.toLocaleString('de-DE') + '€';
  const clamp = (x,min,max)=>Math.max(min,Math.min(max,x));

  function render(amount){
    const a = clamp(Number(amount||0), 0, GOAL);
    const p = GOAL ? a/GOAL : 0;
    fill.style.width = (p*100) + '%';
    pct.textContent  = (p*100).toFixed(1) + '%';
    amt.textContent  = `${fmt(a)} von ${fmt(GOAL)}`;
    try {
      localStorage.setItem('van_amount', a);
    } catch(e){}
    // auch in URL schreiben, damit Notion-Embeds Wert behalten
    const hash = `#amount=${a}&goal=${GOAL}`;
    if (location.hash !== hash) history.replaceState(null,'',hash);
  }

  // Startwerte: URL-Hash > localStorage > 0
  const hs = new URLSearchParams((location.hash||'').slice(1));
  const a0 = Number(hs.get('amount')) || Number(localStorage.getItem('van_amount')) || 0;
  num.value = a0;
  render(a0);

  num.addEventListener('input', ()=> render(num.value));
})();
</script>
